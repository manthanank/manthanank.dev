---
---

<div id="transition-wipe" class="transition-wipe">
  <div class="wipe-layer layer-1"></div>
  <div class="wipe-layer layer-2"></div>
  <div class="wipe-layer layer-3"></div>
</div>

<script>
  function initPageWipe() {
    const wipe = document.getElementById('transition-wipe');
    if (!wipe) return;

    // We use the 'astro:before-preparation' to start the wipe
    document.addEventListener('astro:before-preparation', () => {
      wipe.classList.remove('finished');
      wipe.classList.add('active');
    });

    // We use 'astro:after-swap' to slide it out
    document.addEventListener('astro:after-swap', () => {
      setTimeout(() => {
        wipe.classList.remove('active');
        wipe.classList.add('finished');
      }, 100);
    });
  }

  initPageWipe();
</script>

<style>
  .transition-wipe {
    position: fixed;
    inset: 0;
    z-index: 10001;
    pointer-events: none;
    visibility: hidden;
  }

  .transition-wipe.active,
  .transition-wipe.finished {
    visibility: visible;
  }

  .wipe-layer {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    transform: translateX(-100%);
    transition: transform 0.5s cubic-bezier(0.8, 0, 0.2, 1);
  }

  .layer-1 { background: var(--color-primary); z-index: 3; }
  .layer-2 { background: var(--color-accent); z-index: 2; transition-delay: 0.05s; }
  .layer-3 { background: var(--color-bg); z-index: 1; transition-delay: 0.1s; }

  .transition-wipe.active .wipe-layer {
    transform: translateX(0);
  }

  .transition-wipe.finished .wipe-layer {
    transform: translateX(100%);
  }

  /* After animation completes, reset to start silently */
  .transition-wipe:not(.active):not(.finished) .wipe-layer {
    transform: translateX(-100%);
    transition: none;
  }
</style>
